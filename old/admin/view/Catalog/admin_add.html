{extend name="base" /}

{block name="content"}
<div class="breadcrumbs">
    <div class="breadcrumbs-inner">
        <div class="row m-0">
            <div class="col-sm-4">
                <div class="page-header float-left">
                    <div class="page-title">
                        <h1>添加后台菜单</h1>
                    </div>
                </div>
            </div>
            <div class="col-sm-8">
                <div class="page-header float-right">
                    <div class="page-title">
                        <ol class="breadcrumb text-right">
                            <li><a href="{:url('Index/index')}">首页</a></li>
                            <li><a href="###">菜单管理</a></li>
                            <li><a href="{:url('Catalog/admin')}">后台菜单列表</a></li>
                            <li class="active">添加后台菜单</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="content">
    <div class="animated fadeIn">
        <div class="row">
            <div class="col-lg-12">
                <div class="card">
                    <div class="card-body card-block">
                        <div class="form-group">
                            <label for="title" class=" form-control-label">标题</label>
                            <input type="text" id="title" placeholder="请填写标题" class="form-control">
                        </div>
                        <div class="row form-group">
                            <div class="col col-md-9"><label for="select" class=" form-control-label">所属一级菜单</label></div>
                            <div class="col-12 col-md-12">
                                <select name="top_id" id="top_id" class="form-control">
                                    <option value="0">请选择所属一级菜单(默认为一级菜单)</option>
                                    {volist name="list" id="vo"}
                                    <option value="{$vo.id}">{$vo.title}</option>
                                    {/volist}
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="icon" class="control-label mb-1">图标</label>
                            <div class="input-group">
                                <input id="icon" type="text" class="form-control cc-cvc" placeholder="请填写图标标签">
                                <div class="input-group-addon">
                                    <span id="icon_show" class="fa  fa-lg"></span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="url" class=" form-control-label">菜单路径</label>
                            <input type="text" id="url" placeholder="请填写菜单路径" class="form-control">
                        </div>
                        <div class="row form-group">
                            <div class="col-8">
                                <div class="form-group">
                                    <label for="sort" class="form-control-label">排序</label>
                                    <input type="number" id="sort" value="0" class="form-control" min="0" step="1">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="remark" class=" form-control-label">备注</label>
                            <input type="text" id="remark" placeholder="请填写备注" class="form-control">
                        </div>
                        <div>
                            <button id="submit" type="button" class="btn btn-lg btn-info btn-block">
                                <i class="fa fa-arrow-up fa-lg"></i>&nbsp;
                                <span id="payment-button-amount">提交</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
<div>
{/block}

{block name="custom_js"}
    <script>
        $("#icon").change(function(){
            $("#icon_show").attr('class', 'fa ' + $("#icon").val() + ' fa-lg');
        })

        $("#submit").click(function(){
            var title = $("#title").val();
            var top_id = $("#top_id").val();
            var icon = $("#icon").val();
            var url = $("#url").val();
            var sort = $("#sort").val();
            var remark = $("#remark").val();
            if(title == ''){
                layer.msg('请填写标题！');
                return;
            }
            if(icon == ''){
                layer.msg('请填写图标标签！');
                return;
            }
            $.ajax({
                url: "{:url('Catalog/admin_add_submit')}",
                type: "post",
                data: {title: title, top_id: top_id, sort: sort, icon: icon, url: url, remark: remark},
                success: function(data){
                    layer.msg(data.msg);
                    if(data.status == 1){
                        setTimeout(function(){
                            window.location.href = "{:url('Catalog/admin_add')}";
                        }, 1000);
                    }
                }
            })
        })

        
    </script>
{/block}